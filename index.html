<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AI + Practical Tools Studio</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+KR:wght@400;500;700&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bg-1: #f7f4ec;
      --bg-2: #e2efdc;
      --spot-1: #ffd9b8;
      --spot-2: #cce8bc;
      --ink: #1c2a20;
      --primary: #1e7a52;
      --primary-hover: #146741;
      --primary-2: #f08534;
      --card: rgba(255, 255, 255, 0.8);
      --hero-bg: rgba(255, 255, 255, 0.72);
      --input-bg: #ffffff;
      --out-bg: rgba(255, 255, 255, 0.95);
      --line: rgba(28, 42, 32, 0.12);
      --shadow: 0 14px 32px rgba(20, 38, 28, 0.12);
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: "IBM Plex Sans KR", sans-serif;
      color: var(--ink);
      background:
        radial-gradient(circle at 12% 12%, var(--spot-1) 0, transparent 28%),
        radial-gradient(circle at 87% 80%, var(--spot-2) 0, transparent 32%),
        linear-gradient(135deg, var(--bg-1), var(--bg-2));
      transition: background 240ms ease, color 240ms ease;
    }

    body.dark-mode {
      --bg-1: #101417;
      --bg-2: #1a232c;
      --spot-1: #253246;
      --spot-2: #203a31;
      --ink: #eaf2f8;
      --primary: #3f9bff;
      --primary-hover: #2e85e5;
      --primary-2: #ef9d57;
      --card: rgba(22, 30, 40, 0.84);
      --hero-bg: rgba(20, 28, 38, 0.82);
      --input-bg: #111922;
      --out-bg: rgba(15, 22, 31, 0.95);
      --line: rgba(234, 242, 248, 0.16);
      --shadow: 0 18px 34px rgba(0, 0, 0, 0.45);
    }

    .wrap {
      width: min(1120px, 92%);
      margin: 40px auto 60px;
    }

    .hero {
      background: var(--hero-bg);
      border: 1px solid var(--line);
      border-radius: 22px;
      padding: 26px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(6px);
      animation: rise 650ms ease;
    }

    .hero-top {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 14px;
      flex-wrap: wrap;
    }

    .hero-copy { flex: 1 1 520px; }

    .hero h1 {
      margin: 0 0 10px;
      font-family: "Space Grotesk", sans-serif;
      font-size: clamp(1.8rem, 4vw, 2.8rem);
      letter-spacing: -0.02em;
    }

    .hero p {
      margin: 0;
      line-height: 1.55;
      max-width: 70ch;
      opacity: 0.92;
    }

    .hero-actions {
      display: flex;
      gap: 8px;
      align-items: center;
      flex-wrap: wrap;
    }

    .theme-toggle, .lang-toggle {
      min-width: 120px;
      align-self: center;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 18px;
      margin-top: 18px;
    }

    .tool {
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: 18px;
      padding: 18px;
      box-shadow: var(--shadow);
      animation: rise 700ms ease;
    }

    .tool h2 {
      margin: 0 0 8px;
      font-family: "Space Grotesk", sans-serif;
      font-size: 1.2rem;
    }

    .tool p {
      margin: 0 0 12px;
      font-size: 0.94rem;
      opacity: 0.85;
    }

    .tool.full { grid-column: 1 / -1; }

    textarea, input, select {
      width: 100%;
      border: 1px solid var(--line);
      border-radius: 12px;
      padding: 10px 12px;
      background: var(--input-bg);
      color: var(--ink);
      font: inherit;
      margin-bottom: 10px;
    }

    textarea { min-height: 120px; resize: vertical; }

    .row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }

    .char-row {
      display: grid;
      grid-template-columns: 1fr auto auto;
      gap: 10px;
      align-items: center;
    }

    button {
      border: 0;
      border-radius: 12px;
      padding: 10px 14px;
      font: inherit;
      font-weight: 700;
      background: var(--primary);
      color: #fff;
      cursor: pointer;
      transition: transform 140ms ease, background 180ms ease;
    }

    button:hover {
      background: var(--primary-hover);
      transform: translateY(-1px);
    }

    .ghost { background: var(--primary-2); }

    .canvas-wrap {
      border: 1px dashed var(--line);
      border-radius: 14px;
      background: var(--out-bg);
      padding: 10px;
      margin-top: 6px;
      display: flex;
      justify-content: center;
    }

    #charCanvas {
      width: min(100%, 360px);
      aspect-ratio: 1 / 1;
      border-radius: 12px;
      background: #f0f3f6;
      display: block;
    }

    .out {
      margin-top: 10px;
      background: var(--out-bg);
      border: 1px dashed var(--line);
      border-radius: 12px;
      padding: 12px;
      min-height: 60px;
      white-space: pre-wrap;
      line-height: 1.5;
    }

    @keyframes rise {
      from { opacity: 0; transform: translateY(14px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @media (max-width: 860px) {
      .grid { grid-template-columns: 1fr; }
      .tool.full { grid-column: auto; }
      .row { grid-template-columns: 1fr; }
      .char-row { grid-template-columns: 1fr; }
      .theme-toggle, .lang-toggle { width: 100%; }
      .hero-actions { width: 100%; }
    }
  </style>
</head>
<body>
  <main class="wrap">
    <section class="hero">
      <div class="hero-top">
        <div class="hero-copy">
          <h1 id="heroTitle"></h1>
          <p id="heroDesc"></p>
        </div>
        <div class="hero-actions">
          <button id="langToggle" class="lang-toggle" type="button" onclick="toggleLanguage()"></button>
          <button id="themeToggle" class="theme-toggle" type="button" onclick="toggleTheme()"></button>
        </div>
      </div>
    </section>

    <section class="grid">
      <article class="tool full">
        <h2 id="charTitle"></h2>
        <p id="charDesc"></p>
        <div class="char-row">
          <input id="charInput" type="file" accept="image/*" />
          <button id="charBtn" type="button" onclick="generateCharacter()"></button>
          <button id="charDownloadBtn" type="button" class="ghost" onclick="downloadCharacter()"></button>
        </div>
        <div class="canvas-wrap">
          <canvas id="charCanvas" width="360" height="360"></canvas>
        </div>
        <div id="charOut" class="out"></div>
      </article>

      <article class="tool full">
        <h2 id="sumTitle"></h2>
        <p id="sumDesc"></p>
        <textarea id="sumInput"></textarea>
        <button id="sumBtn" onclick="summarizeText()"></button>
        <div id="sumOut" class="out"></div>
      </article>

      <article class="tool">
        <h2 id="convTitle"></h2>
        <p id="convDesc"></p>
        <div class="row">
          <input id="convValue" type="number" />
          <select id="convType">
            <option value="km-mile" id="convKmMile"></option>
            <option value="mile-km" id="convMileKm"></option>
            <option value="c-f" id="convCF"></option>
            <option value="f-c" id="convFC"></option>
          </select>
        </div>
        <button id="convBtn" onclick="convertUnit()"></button>
        <div id="convOut" class="out"></div>
      </article>

      <article class="tool">
        <h2 id="pwTitle"></h2>
        <p id="pwDesc"></p>
        <div class="row">
          <input id="pwLen" type="number" min="8" max="64" value="14" />
          <select id="pwMode">
            <option value="all" id="pwAll"></option>
            <option value="alnum" id="pwAlnum"></option>
            <option value="letters" id="pwLetters"></option>
          </select>
        </div>
        <button id="pwBtn" class="ghost" onclick="generatePassword()"></button>
        <div id="pwOut" class="out"></div>
      </article>
    </section>
  </main>

  <script>
    let currentLang = 'ko';
    let uploadedImage = null;
    let characterReady = false;

    const I18N = {
      ko: {
        htmlLang: 'ko',
        title: 'AI + 실용 툴 스튜디오',
        heroTitle: 'AI + 실용 툴 스튜디오',
        heroDesc: '사진 기반 캐릭터 생성 기능을 포함해 핵심 4가지 기능을 제공합니다.',
        langToggle: 'English',
        themeLight: '화이트모드',
        themeDark: '블랙모드',
        charTitle: '1) 사진 기반 캐릭터 생성기',
        charDesc: '사진을 업로드하면 닮은 느낌의 카툰 스타일 캐릭터로 변환합니다.',
        charBtn: '캐릭터 만들기',
        charDownloadBtn: '이미지 저장',
        sumTitle: '2) AI 텍스트 요약기',
        sumDesc: '긴 글에서 핵심 문장만 간단히 추출합니다.',
        sumBtn: '요약하기',
        sumPlaceholder: '요약할 텍스트를 입력하세요.',
        convTitle: '3) 단위 변환기',
        convDesc: '길이(km↔mile), 온도(C↔F)를 변환합니다.',
        convBtn: '변환하기',
        convValuePlaceholder: '값 입력',
        convKmMile: 'km → mile',
        convMileKm: 'mile → km',
        convCF: '°C → °F',
        convFC: '°F → °C',
        pwTitle: '4) 안전 비밀번호 생성기',
        pwDesc: '길이/문자 옵션을 선택해 강한 비밀번호를 만듭니다.',
        pwBtn: '생성하기',
        pwAll: '영문+숫자+특수문자',
        pwAlnum: '영문+숫자',
        pwLetters: '영문만',
        defaults: {
          charOut: '업로드 후 캐릭터 만들기를 누르세요.',
          sumOut: '결과가 여기에 표시됩니다.',
          convOut: '변환 결과가 여기에 표시됩니다.',
          pwOut: '생성된 비밀번호가 여기에 표시됩니다.'
        },
        msg: {
          enterText: '텍스트를 먼저 입력하세요.',
          enterNumber: '숫자 값을 입력하세요.',
          photoFirst: '먼저 사진을 업로드하세요.',
          photoLoaded: '사진이 로드되었습니다. 캐릭터 만들기를 눌러주세요.',
          photoError: '이미지를 읽지 못했습니다. 다른 파일로 시도하세요.',
          charDone: '캐릭터 생성이 완료되었습니다.'
        },
        summaryKeywords: ['중요', '핵심', '결론', '문제', '해결', '효율', '성과', '전략']
      },
      en: {
        htmlLang: 'en',
        title: 'AI + Practical Tools Studio',
        heroTitle: 'AI + Practical Tools Studio',
        heroDesc: 'Includes a photo-to-character feature with four practical tools.',
        langToggle: '한국어',
        themeLight: 'Light Mode',
        themeDark: 'Dark Mode',
        charTitle: '1) Photo Character Maker',
        charDesc: 'Upload a photo and convert it into a look-alike cartoon style character.',
        charBtn: 'Create Character',
        charDownloadBtn: 'Save Image',
        sumTitle: '2) AI Text Summarizer',
        sumDesc: 'Extract key sentences from long text quickly.',
        sumBtn: 'Summarize',
        sumPlaceholder: 'Enter text to summarize.',
        convTitle: '3) Unit Converter',
        convDesc: 'Convert length (km↔mile) and temperature (C↔F).',
        convBtn: 'Convert',
        convValuePlaceholder: 'Enter value',
        convKmMile: 'km → mile',
        convMileKm: 'mile → km',
        convCF: '°C → °F',
        convFC: '°F → °C',
        pwTitle: '4) Secure Password Generator',
        pwDesc: 'Generate a strong password with selectable options.',
        pwBtn: 'Generate',
        pwAll: 'Letters + Numbers + Symbols',
        pwAlnum: 'Letters + Numbers',
        pwLetters: 'Letters only',
        defaults: {
          charOut: 'Upload a photo, then click create character.',
          sumOut: 'Results will appear here.',
          convOut: 'Converted result will appear here.',
          pwOut: 'Generated password will appear here.'
        },
        msg: {
          enterText: 'Please enter text first.',
          enterNumber: 'Please enter a numeric value.',
          photoFirst: 'Please upload a photo first.',
          photoLoaded: 'Photo loaded. Click create character.',
          photoError: 'Could not read this image. Try another file.',
          charDone: 'Character creation is complete.'
        },
        summaryKeywords: ['important', 'key', 'conclusion', 'problem', 'solution', 'efficient', 'result', 'strategy']
      }
    };

    function setOutput(id, text, isDefault) {
      const out = document.getElementById(id);
      out.textContent = text;
      out.dataset.default = isDefault ? 'true' : 'false';
    }

    function updateThemeButtonText() {
      const t = I18N[currentLang];
      const isDark = document.body.classList.contains('dark-mode');
      document.getElementById('themeToggle').textContent = isDark ? t.themeLight : t.themeDark;
    }

    function applyTheme(theme) {
      const isDark = theme === 'dark';
      document.body.classList.toggle('dark-mode', isDark);
      localStorage.setItem('themeMode', isDark ? 'dark' : 'light');
      updateThemeButtonText();
    }

    function toggleTheme() {
      const nextTheme = document.body.classList.contains('dark-mode') ? 'light' : 'dark';
      applyTheme(nextTheme);
    }

    function applyLanguage(lang) {
      currentLang = lang === 'en' ? 'en' : 'ko';
      const t = I18N[currentLang];

      document.documentElement.lang = t.htmlLang;
      document.title = t.title;

      document.getElementById('heroTitle').textContent = t.heroTitle;
      document.getElementById('heroDesc').textContent = t.heroDesc;
      document.getElementById('langToggle').textContent = t.langToggle;

      document.getElementById('charTitle').textContent = t.charTitle;
      document.getElementById('charDesc').textContent = t.charDesc;
      document.getElementById('charBtn').textContent = t.charBtn;
      document.getElementById('charDownloadBtn').textContent = t.charDownloadBtn;

      document.getElementById('sumTitle').textContent = t.sumTitle;
      document.getElementById('sumDesc').textContent = t.sumDesc;
      document.getElementById('sumBtn').textContent = t.sumBtn;
      document.getElementById('sumInput').placeholder = t.sumPlaceholder;

      document.getElementById('convTitle').textContent = t.convTitle;
      document.getElementById('convDesc').textContent = t.convDesc;
      document.getElementById('convBtn').textContent = t.convBtn;
      document.getElementById('convValue').placeholder = t.convValuePlaceholder;
      document.getElementById('convKmMile').textContent = t.convKmMile;
      document.getElementById('convMileKm').textContent = t.convMileKm;
      document.getElementById('convCF').textContent = t.convCF;
      document.getElementById('convFC').textContent = t.convFC;

      document.getElementById('pwTitle').textContent = t.pwTitle;
      document.getElementById('pwDesc').textContent = t.pwDesc;
      document.getElementById('pwBtn').textContent = t.pwBtn;
      document.getElementById('pwAll').textContent = t.pwAll;
      document.getElementById('pwAlnum').textContent = t.pwAlnum;
      document.getElementById('pwLetters').textContent = t.pwLetters;

      ['charOut', 'sumOut', 'convOut', 'pwOut'].forEach((id) => {
        const el = document.getElementById(id);
        if (!el.dataset.default || el.dataset.default === 'true') {
          setOutput(id, t.defaults[id], true);
        }
      });

      localStorage.setItem('langMode', currentLang);
      updateThemeButtonText();
    }

    function toggleLanguage() {
      applyLanguage(currentLang === 'ko' ? 'en' : 'ko');
    }

    function drawImageCover(ctx, img, size) {
      const scale = Math.max(size / img.width, size / img.height);
      const w = img.width * scale;
      const h = img.height * scale;
      const x = (size - w) / 2;
      const y = (size - h) / 2;
      ctx.drawImage(img, x, y, w, h);
    }

    function toonEffect(ctx, size) {
      const image = ctx.getImageData(0, 0, size, size);
      const data = image.data;

      for (let i = 0; i < data.length; i += 4) {
        data[i] = Math.min(255, Math.round(data[i] / 48) * 48 + 8);
        data[i + 1] = Math.min(255, Math.round(data[i + 1] / 48) * 48 + 8);
        data[i + 2] = Math.min(255, Math.round(data[i + 2] / 48) * 48 + 8);
      }

      const gray = new Uint8ClampedArray(size * size);
      for (let i = 0, p = 0; i < gray.length; i++, p += 4) {
        gray[i] = (data[p] * 0.299 + data[p + 1] * 0.587 + data[p + 2] * 0.114) | 0;
      }

      for (let y = 1; y < size - 1; y++) {
        for (let x = 1; x < size - 1; x++) {
          const idx = y * size + x;
          const gx = gray[idx + 1] - gray[idx - 1];
          const gy = gray[idx + size] - gray[idx - size];
          const edge = Math.sqrt(gx * gx + gy * gy);
          if (edge > 32) {
            const p = idx * 4;
            data[p] = data[p] * 0.35;
            data[p + 1] = data[p + 1] * 0.35;
            data[p + 2] = data[p + 2] * 0.35;
          }
        }
      }

      ctx.putImageData(image, 0, 0);
    }

    function renderCanvasPlaceholder() {
      const c = document.getElementById('charCanvas');
      const ctx = c.getContext('2d');
      const t = I18N[currentLang];
      ctx.clearRect(0, 0, c.width, c.height);
      const g = ctx.createLinearGradient(0, 0, c.width, c.height);
      g.addColorStop(0, '#dce7f5');
      g.addColorStop(1, '#f5ddcf');
      ctx.fillStyle = g;
      ctx.fillRect(0, 0, c.width, c.height);
      ctx.fillStyle = 'rgba(0,0,0,0.15)';
      ctx.font = '600 18px Space Grotesk, sans-serif';
      ctx.textAlign = 'center';
      ctx.fillText(t.charBtn, c.width / 2, c.height / 2);
    }

    function onPhotoSelected(event) {
      const t = I18N[currentLang];
      const file = event.target.files[0];
      if (!file) {
        uploadedImage = null;
        characterReady = false;
        setOutput('charOut', t.defaults.charOut, true);
        renderCanvasPlaceholder();
        return;
      }

      const reader = new FileReader();
      reader.onload = () => {
        const img = new Image();
        img.onload = () => {
          uploadedImage = img;
          characterReady = false;
          setOutput('charOut', t.msg.photoLoaded, false);
          const c = document.getElementById('charCanvas');
          const ctx = c.getContext('2d');
          ctx.clearRect(0, 0, c.width, c.height);
          drawImageCover(ctx, img, c.width);
        };
        img.onerror = () => {
          uploadedImage = null;
          characterReady = false;
          setOutput('charOut', t.msg.photoError, false);
          renderCanvasPlaceholder();
        };
        img.src = reader.result;
      };
      reader.onerror = () => {
        uploadedImage = null;
        characterReady = false;
        setOutput('charOut', t.msg.photoError, false);
        renderCanvasPlaceholder();
      };
      reader.readAsDataURL(file);
    }

    function generateCharacter() {
      const t = I18N[currentLang];
      if (!uploadedImage) {
        setOutput('charOut', t.msg.photoFirst, false);
        return;
      }

      const c = document.getElementById('charCanvas');
      const ctx = c.getContext('2d');
      const size = c.width;

      const bg = ctx.createLinearGradient(0, 0, size, size);
      bg.addColorStop(0, '#f9c78d');
      bg.addColorStop(1, '#8fc8ff');
      ctx.fillStyle = bg;
      ctx.fillRect(0, 0, size, size);

      drawImageCover(ctx, uploadedImage, size);
      toonEffect(ctx, size);

      ctx.strokeStyle = 'rgba(255,255,255,0.65)';
      ctx.lineWidth = 8;
      ctx.strokeRect(6, 6, size - 12, size - 12);

      characterReady = true;
      setOutput('charOut', t.msg.charDone, false);
    }

    function downloadCharacter() {
      if (!characterReady) {
        const t = I18N[currentLang];
        setOutput('charOut', t.msg.photoFirst, false);
        return;
      }
      const c = document.getElementById('charCanvas');
      const link = document.createElement('a');
      link.download = 'character-avatar.png';
      link.href = c.toDataURL('image/png');
      link.click();
    }

    function summarizeText() {
      const t = I18N[currentLang];
      const input = document.getElementById('sumInput').value.trim();
      if (!input) {
        setOutput('sumOut', t.msg.enterText, false);
        return;
      }

      const sentences = input
        .replace(/\n+/g, ' ')
        .split(/(?<=[.!?])\s+|(?<=[다요])\s+/)
        .filter(Boolean);

      if (sentences.length <= 2) {
        setOutput('sumOut', input, false);
        return;
      }

      const keywords = t.summaryKeywords;
      const scored = sentences.map((s, i) => {
        let score = s.length * 0.01;
        keywords.forEach((k) => {
          if (s.toLowerCase().includes(k.toLowerCase())) score += 1.2;
        });
        if (i === 0 || i === sentences.length - 1) score += 0.4;
        return { s, i, score };
      });

      const pickCount = Math.max(2, Math.ceil(sentences.length * 0.35));
      const summary = scored
        .sort((a, b) => b.score - a.score)
        .slice(0, pickCount)
        .sort((a, b) => a.i - b.i)
        .map((v) => `- ${v.s.trim()}`)
        .join('\n');

      setOutput('sumOut', summary, false);
    }

    function convertUnit() {
      const t = I18N[currentLang];
      const value = Number(document.getElementById('convValue').value);
      const type = document.getElementById('convType').value;

      if (Number.isNaN(value)) {
        setOutput('convOut', t.msg.enterNumber, false);
        return;
      }

      let result = '';
      if (type === 'km-mile') result = `${value} km = ${(value * 0.621371).toFixed(4)} mile`;
      if (type === 'mile-km') result = `${value} mile = ${(value / 0.621371).toFixed(4)} km`;
      if (type === 'c-f') result = `${value} °C = ${(value * 9 / 5 + 32).toFixed(2)} °F`;
      if (type === 'f-c') result = `${value} °F = ${((value - 32) * 5 / 9).toFixed(2)} °C`;
      setOutput('convOut', result, false);
    }

    function generatePassword() {
      const len = Math.min(64, Math.max(8, Number(document.getElementById('pwLen').value) || 14));
      const mode = document.getElementById('pwMode').value;

      const pools = {
        letters: 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ',
        alnum: 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789',
        all: 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()_+-=[]{}'
      };

      const chars = pools[mode];
      let pw = '';
      const rand = new Uint32Array(len);
      crypto.getRandomValues(rand);
      for (let i = 0; i < len; i++) {
        pw += chars[rand[i] % chars.length];
      }
      setOutput('pwOut', pw, false);
    }

    document.getElementById('charInput').addEventListener('change', onPhotoSelected);

    const savedTheme = localStorage.getItem('themeMode');
    const savedLang = localStorage.getItem('langMode');

    applyTheme(savedTheme === 'dark' ? 'dark' : 'light');
    applyLanguage(savedLang === 'en' ? 'en' : 'ko');
    renderCanvasPlaceholder();
  </script>
</body>
</html>
